PEER usage

This document describes usage of the PEER framework that can be
quickly applied 'out-of-the-box'. For more information on the
underlying probabilistic model and inference procedure, see the
publications. Here, we demonstrate how to fit the framework to your
needs on the simulated dataset included in the framework. 

1. Basic application

As a minimum, PEER requires an expression matrix in csv
(comma-separated) format, specified with the -f option. The matrix is
assumed to have N rows and G columns, where N is the number of
samples, and G is the number of genes. The basic command to apply peer
to such a matrix given in expression.csv, learning 10 hidden
confounders is 

> peer -f expression.csv -n 10

PEER can read comma-separated (.csv) or tab separated (.tab) files. If
the expression data file has a header row, you have to give
--has_header switch on the command line.

2. Changing output

The output is written to directory peer_out by default, creating csv
files for the residuals after accounting for the factors
(residuals.csv, NxG matrix), the inferred factors (X.csv, NxK), the
weights of each factor for every gene (W.csv, GxK), and the inverse
variance of the weights (Alpha.csv, Kx1). 

You can change the output directory with the -o option, e.g.
> peer -f expression.csv -n 5 -o peer_k-5

If you are not interested in the posterior estimates of all the
variables, you can suppress their output with switches. For example,
to only output the residuals, you can use

> peer -f expression.csv --no_a_out --no_w_out --no_x_out

The --no_res_out switch suppresses the output of residuals.


3. Including covariates

If there are measured experimental variables that may contribute to
variability in the data, they can be included in the inference, and
specified with the -c flag. 

> peer -f expression.csv -c covariates.csv


4. Inference parameters

As default, PEER iterates through updates of every variable 100
times. To set it to say, 1000, use

> peer -f expression.csv -i 100

PEER finishes if the increase in lower bound on the model evidence
ceases to change, or the variance of the residuals has stabilised. The
limiting values (tolerances) can be specified as

> peer -f expression.csv --bound_tolerance=0.1  --var_tolerance=0.00000001 

In general you can keep the bound tolerance fairly high, but should
keep the variation tolerance quite low compared to the variance of the
expression matrix. If unsure, use the default values.

Finally, the prior parameters on the noise and weight precision
distributions can also be changed. As these are both gamma
distributed, you can specify the a and b parameters of both:

> peer -f expression.csv --e_pa=1.0 --e_pb=0.01 --a_pa=10.0 --a_pb=100
